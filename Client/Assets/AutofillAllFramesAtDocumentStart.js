(()=>{var e={291:()=>{HTMLSelectElement.isInstance=e=>e instanceof HTMLSelectElement,HTMLInputElement.isInstance=e=>e instanceof HTMLInputElement,window.Cu={getWeakReference:e=>({get:()=>e})},HTMLElement.prototype.getAutocompleteInfo=function(){return{_reason:"autocomplete",fieldName:this.getAttribute("autocomplete")??""}}}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,i),s.exports}(()=>{"use strict";i(291);const e={FIELD_STATES:{NORMAL:"NORMAL",AUTO_FILLED:"AUTO_FILLED",PREVIEW:"PREVIEW"},FIELD_NAME_INFO:{name:"name","given-name":"name","additional-name":"name","family-name":"name",organization:"organization","street-address":"address","address-line1":"address","address-line2":"address","address-line3":"address","address-level1":"address","address-level2":"address","postal-code":"address",country:"address","country-name":"address",tel:"tel","tel-country-code":"tel","tel-national":"tel","tel-area-code":"tel","tel-local":"tel","tel-local-prefix":"tel","tel-local-suffix":"tel","tel-extension":"tel",email:"email","cc-name":"creditCard","cc-given-name":"creditCard","cc-additional-name":"creditCard","cc-family-name":"creditCard","cc-number":"creditCard","cc-exp-month":"creditCard","cc-exp-year":"creditCard","cc-exp":"creditCard","cc-type":"creditCard"},ELIGIBLE_INPUT_TYPES:["text","email","tel","number","month"],SECTION_TYPES:{ADDRESS:"address",CREDIT_CARD:"creditCard"},isAddressField(e){return!!this.FIELD_NAME_INFO[e]&&!this.isCreditCardField(e)},isCreditCardField(e){return"creditCard"==this.FIELD_NAME_INFO[e]},getCategoryFromFieldName(e){return this.FIELD_NAME_INFO[e]},getCategoriesFromFieldNames(e){let t=new Set;for(let i of e){let e=this.getCategoryFromFieldName(i);e&&t.add(e)}return Array.from(t)},isFieldVisible:e=>!e.hidden&&"none"!=e.style.display,isCreditCardOrAddressFieldType(e){if(!e)return!1;if(HTMLInputElement.isInstance(e)){if(!this.ELIGIBLE_INPUT_TYPES.includes(e.type))return!1;if(!this.isFieldVisible(e))return!1}else if(!HTMLSelectElement.isInstance(e))return!1;return!0},CC_FATHOM_NONE:0,CC_FATHOM_JS:1,CC_FATHOM_NATIVE:2,isFathomCreditCardsEnabled(e){return e!=this.CC_FATHOM_NONE},formAutofillConfidencesKeyToCCFieldType:e=>({ccNumber:"cc-number",ccName:"cc-name",ccType:"cc-type",ccExp:"cc-exp",ccExpMonth:"cc-exp-month",ccExpYear:"cc-exp-year"}[e])},t=Object.freeze(["amex","cartebancaire","diners","discover","jcb","mastercard","mir","unionpay","visa"]),n={"american express":"amex","master card":"mastercard","union pay":"unionpay"},r=[{type:"amex",start:34,end:34,len:15},{type:"amex",start:37,end:37,len:15},{type:"cartebancaire",start:4035,end:4035,len:16},{type:"cartebancaire",start:4360,end:4360,len:16},{type:"diners",start:300,end:305,len:[14,19]},{type:"diners",start:3095,end:3095,len:[14,19]},{type:"diners",start:36,end:36,len:[14,19]},{type:"diners",start:38,end:39,len:[14,19]},{type:"discover",start:6011,end:6011,len:[16,19]},{type:"discover",start:622126,end:622925,len:[16,19]},{type:"discover",start:624e3,end:626999,len:[16,19]},{type:"discover",start:628200,end:628899,len:[16,19]},{type:"discover",start:64,end:65,len:[16,19]},{type:"jcb",start:3528,end:3589,len:[16,19]},{type:"mastercard",start:2221,end:2720,len:16},{type:"mastercard",start:51,end:55,len:16},{type:"mir",start:2200,end:2204,len:16},{type:"unionpay",start:62,end:62,len:[16,19]},{type:"unionpay",start:81,end:81,len:[16,19]},{type:"visa",start:4,end:4,len:16}].sort(((e,t)=>t.start-e.start));class s{constructor({name:e,number:t,expirationString:i,expirationMonth:n,expirationYear:r,network:a,ccv:l,encryptedNumber:d}){this._name=e,this._unmodifiedNumber=t,this._encryptedNumber=d,this._ccv=l,this.number=t;let{month:o,year:c}=s.normalizeExpiration({expirationString:i,expirationMonth:n,expirationYear:r});this._expirationMonth=o,this._expirationYear=c,this.network=a}set name(e){this._name=e}set expirationMonth(e){this._expirationMonth=void 0!==e?s.normalizeExpirationMonth(e):void 0}get expirationMonth(){return this._expirationMonth}set expirationYear(e){this._expirationYear=void 0!==e?s.normalizeExpirationYear(e):void 0}get expirationYear(){return this._expirationYear}set expirationString(e){let{month:t,year:i}=s.parseExpirationString(e);this.expirationMonth=t,this.expirationYear=i}set ccv(e){this._ccv=e}get number(){return this._number}set number(e){if(e){let t=s.normalizeCardNumber(e);t=t.match(/^\d{12,}$/)?t:"",this._number=t}else this._number="";if(e&&!this.isValidNumber())throw this._number="",new Error("Invalid credit card number")}get network(){return this._network}set network(e){this._network=e||void 0}isValidNumber(){if(!this._number)return!1;let e=this._number.replace(/[\-\s]/g,""),t=e.length;if(t<12||t>19)return!1;if(!/^\d+$/.test(e))return!1;let i=0;for(let n=0;n<t;n++){let r=parseInt(e[t-n-1],10);n%2==1&&(r*=2,r>9&&(r-=9)),i+=r}return i%10==0}static normalizeCardNumber(e){return e?e.replace(/[\-\s]/g,""):null}static getType(e){for(let t=0;t<r.length;t++){const i=r[t];if("number"==typeof i.len){if(i.len!=e.length)continue}else if(e.length<i.len[0]||e.length>i.len[1])continue;const n=Math.floor(Math.log10(i.start))+1,s=parseInt(e.substring(0,n),10);if(s>=i.start&&s<=i.end)return i.type}return null}static getNetworkFromName(e){if(!e)return null;let i=e.trim().toLowerCase().normalize("NFKC");if(t.includes(i))return i;for(let e in n)if(i.includes(e))return n[e];return null}isValid(){if(!this.isValidNumber())return!1;let e=new Date,t=e.getFullYear();if(this._expirationYear>t)return!0;let i=e.getMonth()+1;return this._expirationYear==t&&this._expirationMonth>=i}get maskedNumber(){return s.getMaskedNumber(this._number)}get longMaskedNumber(){return s.getLongMaskedNumber(this._number)}static getLabelInfo({number:e,name:t,month:i,year:n,type:r}){let a=["number"];return t&&a.push("name"),i&&n&&a.push("expiration"),{id:`credit-card-label-${a.join("-")}-2`,args:{number:s.getMaskedNumber(e),name:t,month:i?.toString(),year:n?.toString(),type:r}}}static getLabel({number:e,name:t}){let i=[];return e&&i.push(s.getMaskedNumber(e)),t&&i.push(t),i.join(", ")}static normalizeExpirationMonth(e){if(e=parseInt(e,10),!(isNaN(e)||e<1||e>12))return e}static normalizeExpirationYear(e){if(e=parseInt(e,10),!(isNaN(e)||e<0))return e<100&&(e+=2e3),e}static parseExpirationString(e){let t=[{regex:/(?:^|\D)(\d{2})(\d{2})(?!\d)/},{regex:/(?:^|\D)(\d{4})[-/](\d{1,2})(?!\d)/,yearIndex:0,monthIndex:1},{regex:/(?:^|\D)(\d{1,2})[-/](\d{4})(?!\d)/,yearIndex:1,monthIndex:0},{regex:/(?:^|\D)(\d{1,2})[-/](\d{1,2})(?!\d)/},{regex:/(?:^|\D)(\d{2})(\d{2})(?!\d)/}];e=e.replaceAll(" ","");for(let i of t){let t,n,r=i.regex.exec(e);if(!r)continue;const s=[parseInt(r[1],10),parseInt(r[2],10)];if(i.yearIndex&&i.monthIndex?(t=s[i.yearIndex],n=s[i.monthIndex]):(n=s[0],n>12?(t=s[0],n=s[1]):t=s[1]),n>=1&&n<=12&&(t<100||t>2e3))return{month:n,year:t}}return{month:void 0,year:void 0}}static normalizeExpiration({expirationString:e,expirationMonth:t,expirationYear:i}){let n={};return!e||t&&i||(n=s.parseExpirationString(e)),{month:s.normalizeExpirationMonth(n.month||t),year:s.normalizeExpirationYear(n.year||i)}}static formatMaskedNumber(e){return{affix:"****",label:e.replace(/^\**/,"")}}static getCreditCardLogo(e){const t="chrome://formautofill/content/",i=t+"third-party/";switch(e){case"amex":return i+"cc-logo-amex.png";case"cartebancaire":return i+"cc-logo-cartebancaire.png";case"diners":return i+"cc-logo-diners.svg";case"discover":return i+"cc-logo-discover.png";case"jcb":return i+"cc-logo-jcb.svg";case"mastercard":return i+"cc-logo-mastercard.svg";case"mir":return i+"cc-logo-mir.svg";case"unionpay":return i+"cc-logo-unionpay.svg";case"visa":return i+"cc-logo-visa.svg";default:return t+"icon-credit-card-generic.svg"}}static getMaskedNumber(e){return"*".repeat(4)+" "+e.substr(-4)}static getLongMaskedNumber(e){return"*".repeat(e.length-4)+e.substr(-4)}static isValidNumber(e){try{new s({number:e})}catch(e){return!1}return!0}static isValidNetwork(e){return t.includes(e)}static getSupportedNetworks(){return t}static getNetworkL10nId(e){return this.isValidNetwork(e)?`autofill-card-network-${e}`:null}}const a={EXCLUDED_TAGS:["SCRIPT","NOSCRIPT","OPTION","STYLE"],_mappedLabels:null,_unmappedLabelControls:null,_labelStrings:new WeakMap,extractLabelStrings(e){if(this._labelStrings.has(e))return this._labelStrings.get(e);let t=[],i=e=>{if(!this.EXCLUDED_TAGS.includes(e.tagName))if(e.nodeType!=e.TEXT_NODE&&e.childNodes.length)for(let t of e.childNodes){let e=t.nodeType;e!=t.ELEMENT_NODE&&e!=t.TEXT_NODE||i(t)}else{let i=e.textContent.trim();i&&t.push(i)}};return i(e),this._labelStrings.set(e,t),t},generateLabelMap(e){this._mappedLabels=new Map,this._unmappedLabelControls=[],this._labelStrings=new WeakMap;for(let t of e.querySelectorAll("label")){let e,i=t.htmlFor;if(!i){if(e=t.control,!e)continue;i=e.id}if(i){let e=this._mappedLabels.get(i);e?e.push(t):this._mappedLabels.set(i,[t])}else this._unmappedLabelControls.push({label:t,control:e})}},clearLabelMap(){this._mappedLabels=null,this._unmappedLabelControls=null,this._labelStrings=null},findLabelElements(e){this._mappedLabels||this.generateLabelMap(e.ownerDocument);let t=e.id;return t?this._mappedLabels.get(t)||[]:this._unmappedLabelControls.filter((t=>t.control==e)).map((e=>e.label))}},l=()=>{},d={types:["cc-number","cc-name"]},o="-moz-section-default",c=["address-level3","address-level2","address-level1","tel","postal-code","email","street-address"],u={"cc-number":4};class p{constructor(e,{allowDuplicates:t=!1,sectionEnabled:i=!0}){this._elementsWeakRef=Cu.getWeakReference(e),this.fieldDetails=[],this._parsingIndex=0,this._sections=[],this._allowDuplicates=t,this._sectionEnabled=i}get _elements(){return this._elementsWeakRef.get()}get parsingIndex(){return this._parsingIndex}set parsingIndex(e){if(e>this._elements.length)throw new Error("The parsing index is out of range.");this._parsingIndex=e}getFieldDetailByIndex(e){if(e>=this._elements.length)throw new Error(`The index ${e} is out of range.(${this._elements.length})`);if(e<this.fieldDetails.length)return this.fieldDetails[e];for(let t=this.fieldDetails.length;t<e+1;t++)this.pushDetail();return this.fieldDetails[e]}get parsingFinished(){return this.parsingIndex>=this._elements.length}_pushToSection(e,t){for(let i of this._sections)if(i.name==e)return void i.fieldDetails.push(t);this._sections.push({name:e,fieldDetails:[t]})}_mergeNextNFields(e,t,i,n,r){if(e)e--;else{let s=u[t]-2,a=i.slice(n+1,n+1+s);a.length==s&&a.every((e=>e.fieldName==t))?e=s:r=!0}return{mergeNextNFields:e,createNewSection:r}}_classifySections(){let e=this._sections[0].fieldDetails;this._sections=[];let t,i=new Set,n=0,r=0;for(let s=0;s<e.length;s++){let a=e[s].fieldName;if(!a)continue;let l=!1;i.has(a)&&(t!=a?l=!0:c.includes(a)||(a in u?({mergeNextNFields:r,createNewSection:l}=this._mergeNextNFields(r,a,e,s,l)):l=!0)),l&&(r=0,i.clear(),n++),t=a,i.add(a),this._pushToSection("-moz-section-default-"+n,e[s])}}getSectionFieldDetails(){return this._sectionEnabled?this._sections.length?(1==this._sections.length&&this._sections[0].name==o&&this._classifySections(),this._sections.reduce(((e,t)=>(e.push(...this._getFinalDetails(t.fieldDetails)),e)),[])):[]:this._getFinalDetails(this.fieldDetails)}pushDetail(){let e=this.fieldDetails.length;if(e>=this._elements.length)throw new Error("Try to push the non-existing element info.");let t=this._elements[e],i=h.getInfo(t,this),n={section:i?.section??"",addressType:i?.addressType??"",contactType:i?.contactType??"",fieldName:i?.fieldName??"",confidence:i?.confidence,elementWeakRef:Cu.getWeakReference(t)};i?._reason&&(n._reason=i._reason),this.fieldDetails.push(n),this._pushToSection(this._getSectionName(n),n)}_getSectionName(e){let t=[];return e.section&&t.push(e.section),e.addressType&&t.push(e.addressType),t.length?t.join(" "):o}updateFieldName(e,t){if(e>=this.fieldDetails.length)throw new Error("Try to update the non-existing field detail.");this.fieldDetails[e].fieldName=t}_isSameField(e,t){return e.section==t.section&&e.addressType==t.addressType&&e.fieldName==t.fieldName&&!e.transform&&!t.transform}_transformCCNumberForMultipleFields(e){let t=e.filter((e=>"cc-number"==e.fieldName&&4==e.elementWeakRef.get().maxLength));4==t.length&&(t[0].transform=e=>e.slice(0,4),t[1].transform=e=>e.slice(4,8),t[2].transform=e=>e.slice(8,12),t[3].transform=e=>e.slice(12,16))}_getFinalDetails(t){let i=[],n=[];for(let r of t){let t=r.fieldName;e.isAddressField(t)?i.push(r):e.isCreditCardField(t)?n.push(r):l("Not collecting a field with a unknown fieldName",r)}return this._transformCCNumberForMultipleFields(n),[{type:e.SECTION_TYPES.ADDRESS,fieldDetails:i},{type:e.SECTION_TYPES.CREDIT_CARD,fieldDetails:n}].map((e=>{if(this._allowDuplicates)return e;let t=e.fieldDetails;return e.fieldDetails=t.filter(((e,i)=>!t.slice(0,i).find((t=>this._isSameField(e,t))))),e})).filter((e=>!!e.fieldDetails.length))}elementExisting(e){return e<this._elements.length}getFathomField(e,t){if(!t.length)return[null,null];if(!this._fathomConfidences?.get(e)){this._fathomConfidences=new Map;let t=[];t=this._elements?.includes(e)?this._elements:[e];let i=p.getFormAutofillConfidences(t);for(let e=0;e<t.length;e++)this._fathomConfidences.set(t[e],i[e])}let i=this._fathomConfidences.get(e);if(!i)return[null,null];let n=null,r=.5;for(let[e,s]of Object.entries(i))t.includes(e)&&s>r&&(r=s,n=e);return n?(r=.5,[n,r]):[null,null]}static getFormAutofillConfidences(t){return 1==e.CC_FATHOM_NATIVE?ChromeUtils.getFormAutofillConfidences(t).map((t=>{let i={};for(let[n,r]of Object.entries(t))i[e.formAutofillConfidencesKeyToCCFieldType(n)]=r;return i})):t.map((e=>{let t={};return d.types.map((i=>{t[i]=function(t){const i=d[t].against(e).get(t);return i.length?i[0].scoreFor(t):0}(i)})),t}))}}const m={types:["cc-number","cc-name"]},h={RULES:null,CREDIT_CARD_FIELDNAMES:[],ADDRESS_FIELDNAMES:[],_matchContiguousSubArray:(e,t)=>e.some(((i,n)=>t.every(((t,i)=>t==e[n+i])))),_isExpirationMonthLikely(e){if(!HTMLSelectElement.isInstance(e))return!1;const t=[...e.options],i=Array(12).fill(1).map(((e,t)=>e+t));return!(t.length<12||t.length>13)&&(this._matchContiguousSubArray(t.map((e=>+e.value)),i)||this._matchContiguousSubArray(t.map((e=>+e.label)),i))},_isExpirationYearLikely(e){if(!HTMLSelectElement.isInstance(e))return!1;const t=[...e.options],i=(new Date).getFullYear(),n=Array(3).fill(0).map(((e,t)=>e+i+t));return this._matchContiguousSubArray(t.map((e=>+e.value)),n)||this._matchContiguousSubArray(t.map((e=>+e.label)),n)},_parsePhoneFields(t){let i;const n=this.PHONE_FIELD_GRAMMARS;for(let e=0;e<n.length;e++){let r=t.parsingIndex,s=e;for(;e<n.length&&n[e][0]&&t.elementExisting(r);e++,r++){let i=t.getFieldDetailByIndex(r);if(!i||n[e][0]!=i.fieldName||i._reason&&"autocomplete"==i._reason)break;let s=i.elementWeakRef.get();if(!s)break;if(n[e][2]&&(!s.maxLength||n[e][2]<s.maxLength))break}if(e>=n.length)break;if(!n[e][0]){i={ruleFrom:s,ruleTo:e};break}for(;e<n.length&&n[e][0];e++);}let r=!1;if(i){let{ruleFrom:e,ruleTo:s}=i,a=t.parsingIndex;for(let i=e;i<s;i++)t.updateFieldName(a,n[i][1]),t.parsingIndex++,a++,r=!0}if(t.parsingFinished)return r;let s=t.getFieldDetailByIndex(t.parsingIndex);if(s&&"autocomplete"!=s._reason&&t.parsingIndex>0){const i=new RegExp("\\bext|ext\\b|extension|ramal","iu"),n=t.getFieldDetailByIndex(t.parsingIndex-1),a=e.getCategoryFromFieldName(n.fieldName);n&&"tel"==a&&this._matchRegexp(s.elementWeakRef.get(),i)&&(t.updateFieldName(t.parsingIndex,"tel-extension"),t.parsingIndex++,r=!0)}return r},_parseAddressFields(e){let t=!1;const i=["address-line1","address-line2","address-line3"],n={"address-line1":new RegExp("address[_-]?line(1|one)|address1|addr1|addrline1|address_1|indirizzo1|住所1|地址1|주소.?1","iu"),"address-line2":new RegExp("address[_-]?line(2|two)|address2|addr2|addrline2|address_2|indirizzo2|住所2|地址2|주소.?2","iu"),"address-line3":new RegExp("address[_-]?line(3|three)|address3|addr3|addrline3|address_3|indirizzo3|住所3|地址3|주소.?3","iu")};for(;!e.parsingFinished;){let r=e.getFieldDetailByIndex(e.parsingIndex);if(!r||!i.includes(r.fieldName)||"autocomplete"==r._reason)break;const s=r.elementWeakRef.get();for(let i of Object.keys(n))this._matchRegexp(s,n[i])&&(e.updateFieldName(e.parsingIndex,i),t=!0);e.parsingIndex++}return t},_parseCreditCardFields(t){if(t.parsingFinished)return!1;const i=t.parsingIndex,n=t.getFieldDetailByIndex(t.parsingIndex);if(!n||n._reason&&"autocomplete"==n._reason)return!1;if(!["cc-exp","cc-type","cc-exp-month","cc-exp-year"].includes(n.fieldName))return!1;if(e.isFathomCreditCardsEnabled()&&m.types.includes(n.fieldName))return t.parsingIndex++,!0;const r=n.elementWeakRef.get();if(HTMLSelectElement.isInstance(r))for(let e of r.querySelectorAll("option"))if(s.getNetworkFromName(e.value)||s.getNetworkFromName(e.text))return t.updateFieldName(t.parsingIndex,"cc-type"),t.parsingIndex++,!0;if("month"==r.type)return t.updateFieldName(t.parsingIndex,"cc-exp"),t.parsingIndex++,!0;if("cc-exp-month"==t.getFieldDetailByIndex(t.parsingIndex++).fieldName&&!t.parsingFinished&&"cc-exp-year"==t.getFieldDetailByIndex(t.parsingIndex++).fieldName)return!0;if(t.parsingIndex=i,this._isExpirationMonthLikely(r)&&(t.updateFieldName(t.parsingIndex,"cc-exp-month"),t.parsingIndex++,!t.parsingFinished)){const e=t.getFieldDetailByIndex(t.parsingIndex).elementWeakRef.get();if(this._isExpirationYearLikely(e))return t.updateFieldName(t.parsingIndex,"cc-exp-year"),t.parsingIndex++,!0}if(t.parsingIndex=i,this._findMatchedFieldName(r,["cc-exp-month"])&&(t.updateFieldName(t.parsingIndex,"cc-exp-month"),t.parsingIndex++,!t.parsingFinished)){const e=t.getFieldDetailByIndex(t.parsingIndex).elementWeakRef.get();if(this._findMatchedFieldName(e,["cc-exp-year"]))return t.updateFieldName(t.parsingIndex,"cc-exp-year"),t.parsingIndex++,!0}if(t.parsingIndex=i,this._matchRegexp(r,/^mm$/gi)&&(t.updateFieldName(t.parsingIndex,"cc-exp-month"),t.parsingIndex++,!t.parsingFinished)){const e=t.getFieldDetailByIndex(t.parsingIndex).elementWeakRef.get();if(this._matchRegexp(e,/^(yy|yyyy)$/))return t.updateFieldName(t.parsingIndex,"cc-exp-year"),t.parsingIndex++,!0}return t.parsingIndex=i,this._matchRegexp(r,/(?:exp.*date[^y\\n\\r]*|mm\\s*[-/]?\\s*)yy(?:[^y]|$)/gi)||this._matchRegexp(r,/(?:exp.*date[^y\\n\\r]*|mm\\s*[-/]?\\s*)yyyy(?:[^y]|$)/gi)?(t.updateFieldName(t.parsingIndex,"cc-exp"),t.parsingIndex++,!0):(t.parsingIndex=i,this._findMatchedFieldName(r,["cc-exp"])?(t.updateFieldName(t.parsingIndex,"cc-exp"),t.parsingIndex++,!0):(t.parsingIndex=i,t.updateFieldName(t.parsingIndex,null),t.parsingIndex++,!0))},getFormInfo(t,i=!1){const n=Array.from(t.elements).filter((t=>e.isCreditCardOrAddressFieldType(t)));if(n.length<=0)return[];let r=new p(n,{allowDuplicates:i,sectionEnabled:this._sectionEnabled});for(;!r.parsingFinished;){let e=this._parsePhoneFields(r),t=this._parseAddressFields(r),i=this._parseCreditCardFields(r);e||t||i||r.parsingIndex++}return a.clearLabelMap(),r.getSectionFieldDetails()},_getPossibleFieldNames(e){let t=[],i="off"==e.autocomplete||"off"==e.form?.autocomplete;if(i||t.push(...this.CREDIT_CARD_FIELDNAMES),i||t.push(...this.ADDRESS_FIELDNAMES),HTMLSelectElement.isInstance(e)){const e=["address-level1","address-level2","country","cc-exp-month","cc-exp-year","cc-exp","cc-type"];t=t.filter((t=>e.includes(t)))}return t},getInfo(t,i){function n(e,t=null){return{fieldName:e,section:"",addressType:"",contactType:"",confidence:t}}let r=t.getAutocompleteInfo();if(r&&r.fieldName&&"on"!=r.fieldName&&"off"!=r.fieldName)return r._reason="autocomplete",r;if(!this._prefEnabled)return null;let s=this._getPossibleFieldNames(t);if("email"==t.type&&s.includes("email"))return n("email");if(e.isFathomCreditCardsEnabled()){let e=s.filter((e=>m.types.includes(e))),[r,a]=i.getFathomField(t,e);if(r)return n(r,a)}if(s.length){let e=this._findMatchedFieldName(t,s);if(e)return n(e)}return null},_getElementStrings:e=>({*[Symbol.iterator](){yield e.id,yield e.name,yield e.placeholder?.trim();const t=a.findLabelElements(e);for(let e of t)yield*a.extractLabelStrings(e)}}),_findMatchedFieldName(e,t){const i=this._getElementStrings(e);for(let e of t)for(let t of i)if(this.RULES[e].test(t?.toLowerCase()))return e;return null},_matchRegexp(e,t){const i=this._getElementStrings(e);for(const e of i)if(t.test(e))return!0;return!1},PHONE_FIELD_GRAMMARS:[["tel","tel-country-code",3],["tel","tel-area-code",3],["tel","tel-local-prefix",3],["tel","tel-local-suffix",4],[null,null,0],["tel","tel-area-code",0],["tel","tel-local-prefix",3],["tel","tel-local-suffix",4],[null,null,0]]};class f{constructor(){this.creditCardSections=[]}findForms(e){for(var t=0;t<e.length;t++){var i=e[t];"FORM"===i.nodeName?this.findCreditCardForms(i):i.hasChildNodes()&&this.findForms(i.childNodes)}return!1}findCreditCardForms(t){const i=h.getFormInfo(t).filter((t=>t.type==e.SECTION_TYPES.CREDIT_CARD)).map((e=>e.fieldDetails)),n=i.flatMap((e=>e.map(this.getFieldRef)));return this.creditCardSections.push(...i),n}getFieldRef(e){return e.elementWeakRef.get()}getSectionId(e){const t=(e,t)=>e.some((e=>this.getFieldRef(e)===t));return this.creditCardSections.findIndex((i=>t(i,e)))}fillCCFormFields(e,t){for(let i of e){const e=this.getFieldRef(i);i.fieldName in t&&(e.value=t[i.fieldName])}}fillCreditCardInfo(e){const{id:t,data:i}=JSON.parse(e);this.fillCCFormFields(this.creditCardSections?.[t],i)}}Object.defineProperty(window.__firefox__,"CreditCardHelper",{enumerable:!1,configurable:!1,writable:!1,value:Object.freeze(new class{constructor(){this.onLoad=this.onLoad.bind(this),this.onFocus=this.onFocus.bind(this),this.creditCardAutofill=new f,window.addEventListener("load",this.onLoad)}onLoad(){new MutationObserver((e=>{for(var t=0;t<e.length;++t)this.findForms(e[t].addedNodes)})).observe(document.body,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),[...document.forms].forEach((e=>{this.creditCardAutofill.findCreditCardForms(e).forEach((e=>e.addEventListener("focus",this.onFocus)))}))}onFocus(e){this.sendMessage({msg:"cc-form",id:this.creditCardAutofill.getSectionId(e.target)})}sendMessage(e){window.webkit.messageHandlers.creditCardMessageHandler?.postMessage(e)}fillCreditCardInfo(e){this.creditCardAutofill.fillCreditCardInfo(e)}})})})()})();